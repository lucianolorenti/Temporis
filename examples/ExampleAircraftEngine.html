<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; Temporis  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Target transformation" href="../reference/feature_transformation/target.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Temporis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/installation.html">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/installation.html#installation">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dataset:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/iterators.html">Dataset iterators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Feature Transformation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/index.html">Feature Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/transformer.html">Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/pipeline.html">Transformer pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/step.html">Feature transformation step</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/transformations.html">Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/feature_transformation/target.html">Target transformation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import">Import</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset">Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Number-of-lives-in-the-training-set">Number of lives in the training set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Number-of-lives-in-the-validation-set">Number of lives in the validation set</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Dataset-analysis">Dataset analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Missing-values">Missing values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Variance">Variance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Transformers">Transformers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Functional-API">Functional API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Fitting-the-transformer">Fitting the transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Transforming-a-life">Transforming a life</a></li>
<li class="toctree-l3"><a class="reference internal" href="#More-complex-transformers">More complex transformers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#It-is-possible-to-visualize-the-transformation-pipeline">It is possible to visualize the transformation pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Iterators">Iterators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Lives-iterator">Lives iterator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Transformed-dataset">Transformed dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#WindowedDatasetIterator">WindowedDatasetIterator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Batcher">Batcher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#How-dos-a-sample-looks-like?">How dos a sample looks like?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Model">Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Keras-models">Keras models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Learning-curves">Learning curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Prediction-on-the-validation-set">Prediction on the validation set</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Scikit-learn-and-gradient-boosting-models">Scikit-learn and gradient boosting models</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Temporis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Getting Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/ExampleAircraftEngine.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Getting-Started">
<h1>Getting Started<a class="headerlink" href="#Getting-Started" title="Permalink to this headline"></a></h1>
<p>This guide will make use of the dataset generated with the Commercial Modular Aero-Propulsion System Simulation (C-MAPSS) dynamical model. The dataset consists of multiple multivariate time series. Each data set is further divided into training and test subsets. Each time series is from a different engine - i.e., the data can be considered to be from a fleet of engines of the same type. Each engine starts with different degrees of initial wear and manufacturing variation which is unknown to the
user. This wear and variation are considered normal, i.e., it is not considered a fault condition. There are three operational settings that have a substantial effect on engine performance. These settings are also included in the data. The data are contaminated with sensor noise.</p>
<p>The engine is operating normally at the start of each time series and starts to degrade at some point during the series. In the training set, the degradation grows in magnitude until a predefined threshold is reached beyond which it is not preferable to operate the engine. In the test set, the time series ends some time prior to complete degradation. The objective of the competition is to predict the number of operational cycles after the last cycle that the engine will continue to operate
properly.</p>
<p>The data are provided as a zip-compressed text file with 26 columns of numbers, separated by spaces. Each row is a snapshot of data taken during a single operational cycle; each column is a different variable.</p>
<p>Dataset structure</p>
<ul class="simple">
<li><p>Unit: Engine number [-]</p></li>
<li><p>t: time [cycles]</p></li>
<li><p>0p1: operational setting 1</p></li>
<li><p>op2: operational setting 2</p></li>
<li><p>op3: operational setting 3</p></li>
<li><p>s1: Sensor measurement 1</p></li>
<li><p>s2: Sensor measurement 2 …</p></li>
<li><p>s20: sensor measurement 20</p></li>
</ul>
<p>In the first set of data, there are 100 train trajectories and 100 test trajectories.</p>
<p>[1] A. Saxena, M. Ieee, K. Goebel, D. Simon, and N. Eklund, “Damage Propagation Modeling for Aircraft Engine Prognostics,” Response, 2008.</p>
<section id="Import">
<h2>Import<a class="headerlink" href="#Import" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">temporis.dataset.ts_dataset</span> <span class="kn">import</span> <span class="n">AbstractTimeSeriesDataset</span>
<span class="kn">from</span> <span class="nn">temporis.dataset.CMAPSS</span> <span class="kn">import</span> <span class="p">(</span><span class="n">engines</span><span class="p">,</span> <span class="n">operation_mode</span><span class="p">,</span> <span class="n">process_file_test</span><span class="p">,</span>
                                     <span class="n">process_file_train</span><span class="p">,</span> <span class="n">sensor_indices</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">temporis.dataset.analysis.null</span> <span class="kn">import</span> <span class="p">(</span><span class="n">null_proportion</span><span class="p">,</span> <span class="n">null_proportion_per_life</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">temporis.dataset.analysis.variance</span> <span class="kn">import</span> <span class="n">variance_information</span>

<span class="kn">from</span> <span class="nn">temporis.transformation.features.selection</span> <span class="kn">import</span> <span class="p">(</span><span class="n">ByNameFeatureSelector</span><span class="p">,</span>
                                                        <span class="n">PandasNullProportionSelector</span><span class="p">,</span>
                                                        <span class="n">PandasVarianceThreshold</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">temporis.transformation.features.scalers</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">temporis.transformation.features.imputers</span> <span class="kn">import</span> <span class="p">(</span><span class="n">ForwardFillImputer</span><span class="p">,</span>
                                                         <span class="n">MeanImputer</span><span class="p">,</span>
                                                         <span class="n">RemoveInf</span><span class="p">,</span>
                                                         <span class="n">PerColumnImputer</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">temporis.transformation.features.extraction</span> <span class="kn">import</span> <span class="n">RollingStatistics</span>
<span class="kn">from</span> <span class="nn">temporis.transformation</span> <span class="kn">import</span> <span class="n">Transformer</span><span class="p">,</span> <span class="n">Concatenate</span>

<span class="kn">from</span> <span class="nn">temporis.iterators.iterators</span> <span class="kn">import</span> <span class="p">(</span><span class="n">WindowedDatasetIterator</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">temporis.iterators.shufflers</span> <span class="kn">import</span> <span class="n">NotShuffled</span>
<span class="kn">from</span> <span class="nn">temporis.iterators.batcher</span> <span class="kn">import</span> <span class="n">Batcher</span>
<span class="kn">from</span> <span class="nn">temporis.iterators.utils</span> <span class="kn">import</span> <span class="n">true_values</span>

<span class="kn">from</span> <span class="nn">temporis.models.keras</span> <span class="kn">import</span> <span class="n">tf_regression_dataset</span>
<span class="kn">from</span> <span class="nn">temporis.transformation.functional.pipeline.utils</span> <span class="kn">import</span> <span class="n">plot_pipeline</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-12-16 11:45:15.602872: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2021-12-16 11:45:15.602890: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
</pre></div></div>
</div>
</section>
<section id="Dataset">
<h2>Dataset<a class="headerlink" href="#Dataset" title="Permalink to this headline"></a></h2>
<p>The Dataset comes in a space separated tabular file. The functions <code class="docutils literal notranslate"><span class="pre">process_file_train</span></code> and <code class="docutils literal notranslate"><span class="pre">process_file_test</span></code> receive the filename of the dataset file and return a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with the pre-processed data. The <code class="docutils literal notranslate"><span class="pre">UnitNumber</span></code> column is a life identifier.</p>
<p>In order to define a dataset you should subclass <code class="docutils literal notranslate"><span class="pre">AbstractLivesDataset</span></code> and define three methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__getitem__(self,</span> <span class="pre">i)</span></code>: This method should return the i-th life</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nlives(self)</span></code>: In this method should return the total number of lives present in the dataset</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CMAPSSDataset</span><span class="p">(</span><span class="n">AbstractTimeSeriesDataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">operation_mode</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Invalid model: valid model are </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">operation_mode</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">train</span><span class="p">:</span>
            <span class="n">processing_fun</span> <span class="o">=</span> <span class="n">process_file_train</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">processing_fun</span> <span class="o">=</span> <span class="n">process_file_test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lives</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">engine</span> <span class="ow">in</span> <span class="n">engines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">engine</span> <span class="o">!=</span> <span class="n">model</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">processing_fun</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;UnitNumber&#39;</span><span class="p">):</span>
                <span class="n">g</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;UnitNumber&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lives</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">number_of_samples_of_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lives</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lives</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">CMAPSSDataset</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;FD001&#39;</span><span class="p">)</span>
<span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">CMAPSSDataset</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;FD001&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Number-of-lives-in-the-training-set">
<h3>Number of lives in the training set<a class="headerlink" href="#Number-of-lives-in-the-training-set" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100
</pre></div></div>
</div>
</section>
<section id="Number-of-lives-in-the-validation-set">
<h3>Number of lives in the validation set<a class="headerlink" href="#Number-of-lives-in-the-validation-set" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
100
</pre></div></div>
</div>
</section>
</section>
<section id="Dataset-analysis">
<h2>Dataset analysis<a class="headerlink" href="#Dataset-analysis" title="Permalink to this headline"></a></h2>
<section id="Missing-values">
<h3>Missing values<a class="headerlink" href="#Missing-values" title="Permalink to this headline"></a></h3>
<p>Usually, the information of sensors is incomplete and this causes numerous missing values in the features. This library provides some useful functions to analyse the proportion of the missing values for each feature for each life. In some cases, if the feature values are missing in multiple lives, that feature can be discarded.</p>
<p>Luckily in the NASA dataset, we don’t have any missing values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">null_per_life</span> <span class="o">=</span> <span class="n">null_proportion</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Feature</th>
      <th>Max Null Proportion</th>
      <th>Mean Null Proportion</th>
      <th>Number of lives with more than 80% missing</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>OpSet3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>SensorMeasure13</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>SensorMeasure5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>SensorMeasure11</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>SensorMeasure10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>SensorMeasure14</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>SensorMeasure21</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>OpMode</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>SensorMeasure6</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Cycle</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>SensorMeasure18</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>SensorMeasure3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>SensorMeasure9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>SensorMeasure17</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>OpSet2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>RUL</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>SensorMeasure7</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>OpSet1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SensorMeasure19</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>SensorMeasure2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SensorMeasure15</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SensorMeasure20</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SensorMeasure8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SensorMeasure16</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SensorMeasure12</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SensorMeasure1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>SensorMeasure4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">null_proportion_per_life</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Life</th>
      <th>Number of features</th>
      <th>Number of completely null features</th>
      <th>N of features with 50% null</th>
      <th>N of features with 25% null</th>
      <th>Mean null propotion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>63</th>
      <td>63</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>73</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>72</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>71</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>29</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>28</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>27</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>99</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div></div>
</div>
</section>
<section id="Variance">
<h3>Variance<a class="headerlink" href="#Variance" title="Permalink to this headline"></a></h3>
<p>Another possibility is that sensors do not vary equally in a diverse set of lives. Another function obtains information about the variance of each feature per each life. If a feature variance is zero in many lives, maybe it is a good idea to remove it.</p>
<p>In the NASA dataset, we can see that some of the features have a zero variance in some of the lives.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">var_per_life</span> <span class="o">=</span> <span class="n">variance_information</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Mean std&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Feature</th>
      <th>Min std</th>
      <th>Mean std</th>
      <th>Max std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>OpSet3</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>17</th>
      <td>SensorMeasure18</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>20</th>
      <td>OpMode</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SensorMeasure19</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SensorMeasure16</td>
      <td>0.000000</td>
      <td>5.321406e-18</td>
      <td>1.393232e-17</td>
    </tr>
    <tr>
      <th>23</th>
      <td>SensorMeasure10</td>
      <td>0.000000</td>
      <td>2.203638e-16</td>
      <td>6.677487e-16</td>
    </tr>
    <tr>
      <th>25</th>
      <td>SensorMeasure5</td>
      <td>0.000000</td>
      <td>1.264424e-15</td>
      <td>3.566673e-15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SensorMeasure1</td>
      <td>0.000000</td>
      <td>2.280172e-15</td>
      <td>1.141103e-13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>OpSet2</td>
      <td>0.000269</td>
      <td>2.897551e-04</td>
      <td>3.239132e-04</td>
    </tr>
    <tr>
      <th>19</th>
      <td>SensorMeasure6</td>
      <td>0.000000</td>
      <td>9.590898e-04</td>
      <td>2.881041e-03</td>
    </tr>
    <tr>
      <th>10</th>
      <td>OpSet1</td>
      <td>0.001953</td>
      <td>2.186825e-03</td>
      <td>2.539450e-03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SensorMeasure15</td>
      <td>0.027545</td>
      <td>3.446460e-02</td>
      <td>4.259321e-02</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SensorMeasure8</td>
      <td>0.028232</td>
      <td>5.659648e-02</td>
      <td>8.952233e-02</td>
    </tr>
    <tr>
      <th>14</th>
      <td>SensorMeasure13</td>
      <td>0.031886</td>
      <td>5.727052e-02</td>
      <td>9.244486e-02</td>
    </tr>
    <tr>
      <th>21</th>
      <td>SensorMeasure21</td>
      <td>0.078355</td>
      <td>9.955036e-02</td>
      <td>1.208019e-01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SensorMeasure20</td>
      <td>0.136852</td>
      <td>1.664198e-01</td>
      <td>2.046536e-01</td>
    </tr>
    <tr>
      <th>24</th>
      <td>SensorMeasure11</td>
      <td>0.174484</td>
      <td>2.374455e-01</td>
      <td>3.051670e-01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>SensorMeasure2</td>
      <td>0.372103</td>
      <td>4.628500e-01</td>
      <td>5.770413e-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SensorMeasure12</td>
      <td>0.448932</td>
      <td>6.481781e-01</td>
      <td>8.570263e-01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>SensorMeasure7</td>
      <td>0.567381</td>
      <td>7.864672e-01</td>
      <td>1.058392e+00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>SensorMeasure17</td>
      <td>1.145231</td>
      <td>1.450997e+00</td>
      <td>1.740057e+00</td>
    </tr>
    <tr>
      <th>16</th>
      <td>SensorMeasure3</td>
      <td>4.589708</td>
      <td>5.788760e+00</td>
      <td>7.060648e+00</td>
    </tr>
    <tr>
      <th>26</th>
      <td>SensorMeasure4</td>
      <td>6.281455</td>
      <td>8.118497e+00</td>
      <td>1.004518e+01</td>
    </tr>
    <tr>
      <th>22</th>
      <td>SensorMeasure14</td>
      <td>2.920401</td>
      <td>1.180401e+01</td>
      <td>3.387741e+01</td>
    </tr>
    <tr>
      <th>15</th>
      <td>SensorMeasure9</td>
      <td>3.845202</td>
      <td>1.418905e+01</td>
      <td>4.043659e+01</td>
    </tr>
    <tr>
      <th>12</th>
      <td>RUL</td>
      <td>37.094474</td>
      <td>5.970072e+01</td>
      <td>1.046446e+02</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Cycle</td>
      <td>37.094474</td>
      <td>5.970072e+01</td>
      <td>1.046446e+02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Transformers">
<h2>Transformers<a class="headerlink" href="#Transformers" title="Permalink to this headline"></a></h2>
<p>Transformers are defined using an API similar to the keras functional API.</p>
<p>Two tarnsformer pipelines have to be defined: * How the data is going to be transformed * This transformer invovles selecting and transforming and generating features * How the target is going to be transformed * This transformer involves selecting and transforming the target</p>
<section id="Functional-API">
<h3>Functional API<a class="headerlink" href="#Functional-API" title="Permalink to this headline"></a></h3>
<p>Following the literature, the future that addresses this dataset, only a subset of the feature are going to be used to fit our model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sensor_indices</span><span class="p">]</span>
<span class="n">features</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;SensorMeasure2&#39;,
 &#39;SensorMeasure3&#39;,
 &#39;SensorMeasure4&#39;,
 &#39;SensorMeasure7&#39;,
 &#39;SensorMeasure8&#39;,
 &#39;SensorMeasure9&#39;,
 &#39;SensorMeasure11&#39;,
 &#39;SensorMeasure12&#39;,
 &#39;SensorMeasure13&#39;,
 &#39;SensorMeasure14&#39;,
 &#39;SensorMeasure15&#39;,
 &#39;SensorMeasure17&#39;,
 &#39;SensorMeasure20&#39;,
 &#39;SensorMeasure21&#39;]
</pre></div></div>
</div>
<p>The transformation of the input data will be simple, a feature scaling between -1 and 1 and imputing any missing value or non finite.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional_pipe</span> <span class="o">=</span> <span class="n">ByNameFeatureSelector</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">functional_pipe</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))(</span><span class="n">functional_pipe</span><span class="p">)</span>
<span class="n">functional_pipe</span> <span class="o">=</span> <span class="n">MeanImputer</span><span class="p">()(</span><span class="n">functional_pipe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>One common approach for handling PM problems is to downplay the early stages of the execution due to the fact that that is harder to detect indication of degradation at the beggining.</p>
<p>For this dataset, a piece-wise linear degradation model has been validated to be suitable and effective. In general, the engine unit works normally in the early age and degrades linearly afterwards. It is assumed to have a constant RUL label in the initial period. [1]</p>
<p>[1] Li, X., Ding, Q., &amp; Sun, J. Q. (2018). Remaining useful life estimation in prognostics using deep convolution neural networks. Reliability Engineering &amp; System Safety, 172, 1-11.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_pipe</span> <span class="o">=</span> <span class="n">ByNameFeatureSelector</span><span class="p">([</span><span class="s1">&#39;RUL&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional_transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span>
    <span class="n">transformerX</span><span class="o">=</span><span class="n">functional_pipe</span><span class="p">,</span>
    <span class="n">transformerY</span><span class="o">=</span><span class="n">target_pipe</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="Fitting-the-transformer">
<h3>Fitting the transformer<a class="headerlink" href="#Fitting-the-transformer" title="Permalink to this headline"></a></h3>
<p>The transformer must be fitted on the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">functional_transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;temporis.transformation.functional.transformers.Transformer at 0x7f2104b0a580&gt;
</pre></div></div>
</div>
</section>
<section id="Transforming-a-life">
<h3>Transforming a life<a class="headerlink" href="#Transforming-a-life" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">functional_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(192, 14)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_35_0.png" src="../_images/examples_ExampleAircraftEngine_35_0.png" />
</div>
</div>
</section>
<section id="More-complex-transformers">
<h3>More complex transformers<a class="headerlink" href="#More-complex-transformers" title="Permalink to this headline"></a></h3>
<p>More complex transformers can also be constructed. For example, we may want to use the raw features but also extract some statistics from a subset of features. In this case, we are going to obtain the kurtosis and the peak coefficient using a rolling window for 3 features. There are a lot of different feature extraction and transformation steps that can be applied. I encourage you to check the documentation to discover more.</p>
<p>The number of features we are going to obtain at the end will be the 14 coming from the raw features and 6=2*3 coming for the two statistics computed from the selected subset of size 3.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_pipe</span> <span class="o">=</span> <span class="n">ByNameFeatureSelector</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">raw_pipe</span> <span class="o">=</span> <span class="n">ForwardFillImputer</span><span class="p">()(</span><span class="n">raw_pipe</span><span class="p">)</span>
<span class="n">raw_pipe</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;raw_scaled&#39;</span><span class="p">)(</span><span class="n">raw_pipe</span><span class="p">)</span>

<span class="n">transformed_pipe</span> <span class="o">=</span> <span class="n">ByNameFeatureSelector</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">transformed_pipe</span> <span class="o">=</span> <span class="n">RollingStatistics</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">to_compute</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kurtosis&#39;</span><span class="p">,</span> <span class="s1">&#39;peak&#39;</span><span class="p">])(</span><span class="n">transformed_pipe</span><span class="p">)</span>
<span class="n">transformed_pipe</span> <span class="o">=</span> <span class="n">MeanImputer</span><span class="p">()(</span><span class="n">transformed_pipe</span><span class="p">)</span>
<span class="n">transformed_pipe</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;transformed_scaled&#39;</span><span class="p">)(</span><span class="n">transformed_pipe</span><span class="p">)</span>


<span class="n">pipe</span> <span class="o">=</span> <span class="n">Concatenate</span><span class="p">()([</span><span class="n">raw_pipe</span><span class="p">,</span> <span class="n">transformed_pipe</span><span class="p">])</span>

<span class="n">target_pipe</span> <span class="o">=</span> <span class="n">ByNameFeatureSelector</span><span class="p">([</span><span class="s1">&#39;RUL&#39;</span><span class="p">])</span>

<span class="n">complex_transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span>
    <span class="n">transformerX</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
    <span class="n">transformerY</span><span class="o">=</span><span class="n">target_pipe</span><span class="p">)</span>

<span class="n">complex_transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;temporis.transformation.functional.transformers.Transformer at 0x7f21049efb50&gt;
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="It-is-possible-to-visualize-the-transformation-pipeline">
<h1>It is possible to visualize the transformation pipeline<a class="headerlink" href="#It-is-possible-to-visualize-the-transformation-pipeline" title="Permalink to this headline"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_pipeline</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="s1">&#39;Complex transformer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_39_0.svg" src="../_images/examples_ExampleAircraftEngine_39_0.svg" /></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">complex_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The number of features as expected is 20 features: 14 from the raw features and 6 from the extracted ones</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(192, 20)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_43_0.png" src="../_images/examples_ExampleAircraftEngine_43_0.png" />
</div>
</div>
<p>The name of the obtained features are computed from the step names and the selected features</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">complex_transformer</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;raw_scaled_0_SensorMeasure2&#39;, &#39;raw_scaled_0_SensorMeasure3&#39;,
       &#39;raw_scaled_0_SensorMeasure4&#39;, &#39;raw_scaled_0_SensorMeasure7&#39;,
       &#39;raw_scaled_0_SensorMeasure8&#39;, &#39;raw_scaled_0_SensorMeasure9&#39;,
       &#39;raw_scaled_0_SensorMeasure11&#39;, &#39;raw_scaled_0_SensorMeasure12&#39;,
       &#39;raw_scaled_0_SensorMeasure13&#39;, &#39;raw_scaled_0_SensorMeasure14&#39;,
       &#39;raw_scaled_0_SensorMeasure15&#39;, &#39;raw_scaled_0_SensorMeasure17&#39;,
       &#39;raw_scaled_0_SensorMeasure20&#39;, &#39;raw_scaled_0_SensorMeasure21&#39;,
       &#39;transformed_scaled_1_SensorMeasure2_kurtosis&#39;,
       &#39;transformed_scaled_1_SensorMeasure2_peak&#39;,
       &#39;transformed_scaled_1_SensorMeasure3_kurtosis&#39;,
       &#39;transformed_scaled_1_SensorMeasure3_peak&#39;,
       &#39;transformed_scaled_1_SensorMeasure4_kurtosis&#39;,
       &#39;transformed_scaled_1_SensorMeasure4_peak&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<section id="Iterators">
<h2>Iterators<a class="headerlink" href="#Iterators" title="Permalink to this headline"></a></h2>
<section id="Lives-iterator">
<h3>Lives iterator<a class="headerlink" href="#Lives-iterator" title="Permalink to this headline"></a></h3>
<p>The dataset can be iterated. Each element of the iteration is life in stored in <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> which contains all the features</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;Cycle&#39;, &#39;OpSet1&#39;, &#39;OpSet2&#39;, &#39;OpSet3&#39;, &#39;SensorMeasure1&#39;,
       &#39;SensorMeasure2&#39;, &#39;SensorMeasure3&#39;, &#39;SensorMeasure4&#39;, &#39;SensorMeasure5&#39;,
       &#39;SensorMeasure6&#39;, &#39;SensorMeasure7&#39;, &#39;SensorMeasure8&#39;, &#39;SensorMeasure9&#39;,
       &#39;SensorMeasure10&#39;, &#39;SensorMeasure11&#39;, &#39;SensorMeasure12&#39;,
       &#39;SensorMeasure13&#39;, &#39;SensorMeasure14&#39;, &#39;SensorMeasure15&#39;,
       &#39;SensorMeasure16&#39;, &#39;SensorMeasure17&#39;, &#39;SensorMeasure18&#39;,
       &#39;SensorMeasure19&#39;, &#39;SensorMeasure20&#39;, &#39;SensorMeasure21&#39;, &#39;RUL&#39;,
       &#39;OpMode&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">life</span> <span class="ow">in</span> <span class="n">train_dataset</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">life</span><span class="p">[</span><span class="s1">&#39;RUL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_49_0.png" src="../_images/examples_ExampleAircraftEngine_49_0.png" />
</div>
</div>
</section>
<section id="Transformed-dataset">
<h3>Transformed dataset<a class="headerlink" href="#Transformed-dataset" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transformed_ds</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">complex_transformer</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="n">transformed_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="WindowedDatasetIterator">
<h3>WindowedDatasetIterator<a class="headerlink" href="#WindowedDatasetIterator" title="Permalink to this headline"></a></h3>
<p>The windowed dataset iterator provides a way of iterating the transformed dataset trough an sliding window. The sample for the i-th element, provides the (window-1) elements of the window. It also provides capabilities to shuffle in diverse ways the how the samples are delivered by the iterator.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">WindowedDatasetIterator</span><span class="p">(</span>
    <span class="n">transformed_ds</span><span class="p">,</span>
    <span class="n">window</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since we are using the functional_transformer that only has 14 feature and a window size of 7 samples. The output of one element of the iterator wil be a matrix ox size (7 x14)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(7, 20)
</pre></div></div>
</div>
</section>
</section>
<section id="Batcher">
<h2>Batcher<a class="headerlink" href="#Batcher" title="Permalink to this headline"></a></h2>
<p>The batcher class make use of the <code class="docutils literal notranslate"><span class="pre">WindowedDatasetIterator</span></code> to generate batches of samples.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">66</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">train_batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">transformed_ds</span><span class="p">,</span>
                            <span class="n">window</span><span class="p">,</span>
                            <span class="n">batch_size</span><span class="p">,</span>
                            <span class="n">step</span><span class="p">,</span>
                            <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_batcher</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As expected the shape of the input data of one batch is: * 66 due to the batch size * 25 because the lookback window size * 14 for the selected features in the transformer</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(66, 25, 20)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(66, 1, 1)
</pre></div></div>
</div>
<section id="How-dos-a-sample-looks-like?">
<h3>How dos a sample looks like?<a class="headerlink" href="#How-dos-a-sample-looks-like?" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="p">:,</span> <span class="n">f</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Values of the features to predict the marked point in the lookback window&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RUL of the complete life&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">45</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Point to predict&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f2106628c10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_63_1.png" src="../_images/examples_ExampleAircraftEngine_63_1.png" />
</div>
</div>
</section>
</section>
<section id="Model">
<h2>Model<a class="headerlink" href="#Model" title="Permalink to this headline"></a></h2>
<p>There are utilities available to fit models with common machine learning frameworks</p>
<section id="Keras-models">
<h3>Keras models<a class="headerlink" href="#Keras-models" title="Permalink to this headline"></a></h3>
<p>Let’s create a simple model in keras with some FC layers.</p>
<p>First of all we need to create two batchers for feeding the model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train_transformed_ds</span><span class="p">,</span> <span class="n">val_transformed_ds</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">transformed_ds</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>

<span class="n">window</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">train_iterator</span> <span class="o">=</span> <span class="n">WindowedDatasetIterator</span><span class="p">(</span>
    <span class="n">train_transformed_ds</span><span class="p">,</span>
    <span class="n">window</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>

<span class="n">val_iterator</span> <span class="o">=</span> <span class="n">WindowedDatasetIterator</span><span class="p">(</span>
    <span class="n">val_transformed_ds</span><span class="p">,</span>
    <span class="n">window</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>


<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">iterator</span><span class="o">.</span><span class="n">input_shape</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mae&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;model&#34;
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_1 (InputLayer)        [(None, 7, 20)]           0

 flatten (Flatten)           (None, 140)               0

 dense (Dense)               (None, 32)                4512

 dense_1 (Dense)             (None, 1)                 33

=================================================================
Total params: 4,545
Trainable params: 4,545
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-12-16 11:45:25.381319: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcuda.so.1&#39;; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-12-16 11:45:25.381338: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)
2021-12-16 11:45:25.381352: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (lolo): /proc/driver/nvidia/version does not exist
2021-12-16 11:45:25.381548: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf_train_data</span> <span class="o">=</span> <span class="n">tf_regression_dataset</span><span class="p">(</span><span class="n">train_iterator</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="n">tf_val_data</span> <span class="o">=</span> <span class="n">tf_regression_dataset</span><span class="p">(</span><span class="n">val_iterator</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tf_train_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="n">tf_val_data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/12
267/267 [==============================] - 5s 19ms/step - loss: 80.6171 - val_loss: 44.9364
Epoch 2/12
267/267 [==============================] - 2s 8ms/step - loss: 36.5534 - val_loss: 31.8730
Epoch 3/12
267/267 [==============================] - 2s 8ms/step - loss: 32.0044 - val_loss: 32.5382
Epoch 4/12
267/267 [==============================] - 2s 8ms/step - loss: 31.6509 - val_loss: 32.5857
Epoch 5/12
267/267 [==============================] - 2s 7ms/step - loss: 31.4467 - val_loss: 32.5764
Epoch 6/12
267/267 [==============================] - 2s 8ms/step - loss: 31.2683 - val_loss: 32.5467
Epoch 7/12
267/267 [==============================] - 2s 8ms/step - loss: 31.1052 - val_loss: 32.5342
Epoch 8/12
267/267 [==============================] - 2s 8ms/step - loss: 30.9527 - val_loss: 32.5273
Epoch 9/12
267/267 [==============================] - 2s 8ms/step - loss: 30.7945 - val_loss: 32.4999
Epoch 10/12
267/267 [==============================] - 2s 8ms/step - loss: 30.6293 - val_loss: 32.4655
Epoch 11/12
267/267 [==============================] - 2s 8ms/step - loss: 30.4720 - val_loss: 32.4534
Epoch 12/12
267/267 [==============================] - 2s 8ms/step - loss: 30.3150 - val_loss: 32.4358
</pre></div></div>
</div>
<section id="Learning-curves">
<h4>Learning curves<a class="headerlink" href="#Learning-curves" title="Permalink to this headline"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MAE&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f2106804550&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_70_1.png" src="../_images/examples_ExampleAircraftEngine_70_1.png" />
</div>
</div>
</section>
<section id="Prediction-on-the-validation-set">
<h4>Prediction on the validation set<a class="headerlink" href="#Prediction-on-the-validation-set" title="Permalink to this headline"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tf_val_data</span><span class="p">))</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">true_values</span><span class="p">(</span><span class="n">tf_val_data</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f210010b2e0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_72_1.png" src="../_images/examples_ExampleAircraftEngine_72_1.png" />
</div>
</div>
</section>
</section>
<section id="Scikit-learn-and-gradient-boosting-models">
<h3>Scikit-learn and gradient boosting models<a class="headerlink" href="#Scikit-learn-and-gradient-boosting-models" title="Permalink to this headline"></a></h3>
<p>Following the same API we can create scikit-learn and XGBoost models for regressing our data.</p>
<p>In the following example we are going to create a RandomForestRegressor to predict the RUL of the same dataset</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train_transformed_ds</span><span class="p">,</span> <span class="n">val_transformed_ds</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">transformed_ds</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>

<span class="n">window</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">train_iterator</span> <span class="o">=</span> <span class="n">WindowedDatasetIterator</span><span class="p">(</span>
    <span class="n">train_transformed_ds</span><span class="p">,</span>
    <span class="n">window</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>

<span class="n">val_iterator</span> <span class="o">=</span> <span class="n">WindowedDatasetIterator</span><span class="p">(</span>
    <span class="n">val_transformed_ds</span><span class="p">,</span>
    <span class="n">window</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffler</span><span class="o">=</span><span class="n">NotShuffled</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>



<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">sw_train</span> <span class="o">=</span> <span class="n">train_iterator</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RandomForestRegressor(max_depth=5)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">sw_val</span> <span class="o">=</span> <span class="n">val_iterator</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

<span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_rf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f20e015bca0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ExampleAircraftEngine_77_1.png" src="../_images/examples_ExampleAircraftEngine_77_1.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../reference/feature_transformation/target.html" class="btn btn-neutral float-left" title="Target transformation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>